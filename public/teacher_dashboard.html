<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Intern Performance Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        th.sortable:hover {
            cursor: pointer;
            background-color: #e5e7eb;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
            justify-content: center;
            align-items: center;
        }
        .task-tooltip {
            position: fixed;
            top: 0;
            left: 0;
            z-index: 100;
            display: none;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <div class="container mx-auto p-4 md:p-8">
        <!-- Main Header -->
        <header class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 md:mb-8">
            <h1 class="text-3xl font-bold text-gray-800 mb-2 md:mb-0">Intern Performance Dashboard</h1>
            <div class="flex flex-col sm:flex-row items-center space-y-2 sm:space-y-0 sm:space-x-4 w-full md:w-auto">
                <button id="add-intern-btn" class="w-full sm:w-auto bg-blue-600 text-white font-semibold py-2 px-4 rounded-full shadow-lg hover:bg-blue-700 transition duration-300">
                    Add New Intern
                </button>
                <button id="generate-report-btn" class="w-full sm:w-auto bg-blue-600 text-white font-semibold py-2 px-4 rounded-full shadow-lg hover:bg-blue-700 transition duration-300">
                    Generate Report
                </button>
                <button class="w-full sm:w-auto bg-gray-200 text-gray-800 font-semibold py-2 px-4 rounded-full shadow-lg hover:bg-gray-300 transition duration-300">
                    Export Report
                </button>
            </div>
        </header>

        <!-- Message Box for Success Message -->
        <div id="message-box" class="hidden bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded-xl relative mb-6" role="alert">
            <strong class="font-bold">Success!</strong>
            <span class="block sm:inline ml-2">New report generation has been initiated. You will be notified when it's complete.</span>
            <span class="absolute top-0 bottom-0 right-0 px-4 py-3 cursor-pointer" onclick="document.getElementById('message-box').classList.add('hidden')">
                <svg class="fill-current h-6 w-6 text-green-500" role="button" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><title>Close</title><path d="M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"/></svg>
            </span>
        </div>

        <!-- Key Metrics Section -->
        <section class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <!-- Metric Card 1: Tasks Completed -->
            <div class="bg-white p-6 rounded-2xl shadow-md border border-gray-200 hover:shadow-xl transition duration-300">
                <div class="text-sm font-semibold text-gray-500 mb-2">Total Tasks Completed</div>
                <div id="total-tasks" class="text-3xl font-bold text-gray-900">0</div>
                <div class="flex items-center text-sm mt-2">
                    <span class="text-green-500 mr-1">&#9650;</span>
                    <span class="text-gray-600">Up 15% from last month</span>
                </div>
            </div>
            
            <!-- Metric Card 2: Average Score -->
            <div class="bg-white p-6 rounded-2xl shadow-md border border-gray-200 hover:shadow-xl transition duration-300">
                <div class="text-sm font-semibold text-gray-500 mb-2">Average Task Score</div>
                <div id="average-score" class="text-3xl font-bold text-gray-900">0<span class="text-xl font-normal text-gray-500">/100</span></div>
                <div class="flex items-center text-sm mt-2">
                    <span class="text-red-500 mr-1">&#9660;</span>
                    <span class="text-gray-600">Down 2% from last month</span>
                </div>
            </div>

            <!-- Metric Card 3: Projects Assigned -->
            <div class="bg-white p-6 rounded-2xl shadow-md border border-gray-200 hover:shadow-xl transition duration-300">
                <div class="text-sm font-semibold text-gray-500 mb-2">Projects Assigned</div>
                <div id="projects-assigned" class="text-3xl font-bold text-gray-900">0</div>
                <div class="flex items-center text-sm mt-2">
                    <span class="text-green-500 mr-1">&#9650;</span>
                    <span class="text-gray-600">Up 1 project from last month</span>
                </div>
            </div>

            <!-- Metric Card 4: Actionable Insights -->
            <div class="bg-white p-6 rounded-2xl shadow-md border border-gray-200 hover:shadow-xl transition duration-300">
                <div class="text-sm font-semibold text-gray-500 mb-2">Actionable Insights</div>
                <div id="actionable-insights" class="text-3xl font-bold text-gray-900">0</div>
                <div class="flex items-center text-sm mt-2">
                    <span class="text-gray-600">Generated automatically</span>
                </div>
            </div>
        </section>

        <!-- New Section: Performance Chart -->
        <section class="bg-white p-6 md:p-8 rounded-2xl shadow-lg border border-gray-200 mb-8">
            <h2 class="text-2xl font-semibold text-gray-800 mb-6">Task Completion Over Time</h2>
            <!-- Canvas for Chart.js -->
            <canvas id="performanceChart" class="w-full h-[1024px]"></canvas>
        </section>

        <!-- Main Content Section: Report Breakdown -->
        <section class="bg-white p-6 md:p-8 rounded-2xl shadow-lg border border-gray-200">
            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6">
                <h2 class="text-2xl font-semibold text-gray-800 mb-4 sm:mb-0">Intern Performance Breakdown</h2>
                <div class="flex flex-col sm:flex-row items-start sm:items-center space-y-2 sm:space-y-0 sm:space-x-4 w-full sm:w-auto">
                    <!-- Search Bar -->
                    <input type="text" id="search-input" placeholder="Search by name or project..." class="p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200 w-full sm:w-auto">
                    <!-- Filter Dropdown - Project -->
                    <select id="project-filter" class="p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200 w-full sm:w-auto">
                        <option value="all">All Projects</option>
                        <!-- Options will be populated by JS -->
                    </select>
                    <!-- Filter Dropdown - Status -->
                    <select id="status-filter" class="p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200 w-full sm:w-auto">
                        <option value="all">All Statuses</option>
                        <option value="Completed">Completed</option>
                        <option value="In Progress">In Progress</option>
                        <option value="Not Started">Not Started</option>
                    </select>
                </div>
            </div>
            
            <!-- Table for Report Data -->
            <div class="overflow-x-auto">
                <table class="min-w-full bg-white">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="py-3 px-6 text-left text-sm font-medium text-gray-500 uppercase tracking-wider sortable" data-sort="name">Intern Name</th>
                            <th class="py-3 px-6 text-left text-sm font-medium text-gray-500 uppercase tracking-wider sortable" data-sort="project">Projects</th>
                            <th class="py-3 px-6 text-left text-sm font-medium text-gray-500 uppercase tracking-wider sortable" data-sort="status">Status</th>
                            <th class="py-3 px-6 text-left text-sm font-medium text-gray-500 uppercase tracking-wider sortable" data-sort="score">Avg Score</th>
                            <th class="py-3 px-6 text-left text-sm font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="intern-table-body" class="divide-y divide-gray-200">
                        <!-- Table rows will be dynamically inserted here -->
                    </tbody>
                </table>
            </div>
        </section>
    </div>

    <!-- Intern Profile Modal -->
    <div id="profile-modal" class="modal">
        <div class="bg-white p-6 rounded-2xl shadow-xl w-11/12 md:w-2/3 lg:w-1/2">
            <div class="flex justify-between items-center mb-4">
                <h3 id="modal-title" class="text-xl font-bold text-gray-800">Intern Profile</h3>
                <button onclick="document.getElementById('profile-modal').style.display='none'" class="text-gray-500 hover:text-gray-800 transition-colors">&times;</button>
            </div>
            <form id="profile-form">
                <input type="hidden" id="intern-id">
                <div class="mb-4">
                    <label for="intern-name" class="block text-sm font-medium text-gray-700">Intern Name</label>
                    <input type="text" id="intern-name" class="mt-1 block w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div class="flex justify-end space-x-4 mt-6">
                    <button type="button" id="delete-intern-btn" class="bg-red-500 text-white font-semibold py-2 px-4 rounded-full shadow-lg hover:bg-red-600 transition duration-300">
                        Delete
                    </button>
                    <button type="submit" id="save-intern-btn" class="bg-blue-600 text-white font-semibold py-2 px-4 rounded-full shadow-lg hover:bg-blue-700 transition duration-300">
                        Save Changes
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Task Details Modal -->
    <div id="task-modal" class="modal">
        <div class="bg-white p-6 rounded-2xl shadow-xl w-11/12 md:w-2/3 lg:w-1/2">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-gray-800">Task Details for <span id="task-modal-intern-name"></span></h3>
                <button onclick="document.getElementById('task-modal').style.display='none'" class="text-gray-500 hover:text-gray-800 transition-colors">&times;</button>
            </div>
            <div class="overflow-x-auto mb-4">
                <table class="min-w-full bg-white">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="py-3 px-6 text-left text-sm font-medium text-gray-500 uppercase tracking-wider">Task</th>
                            <th class="py-3 px-6 text-left text-sm font-medium text-gray-500 uppercase tracking-wider">Status</th>
                            <th class="py-3 px-6 text-left text-sm font-medium text-gray-500 uppercase tracking-wider">Score</th>
                        </tr>
                    </thead>
                    <tbody id="task-table-body" class="divide-y divide-gray-200">
                        <!-- Task rows will be dynamically inserted here -->
                    </tbody>
                </table>
            </div>
            <div class="flex justify-end">
                <button id="add-task-btn" class="bg-green-600 text-white font-semibold py-2 px-4 rounded-full shadow-lg hover:bg-green-700 transition duration-300">
                    Add New Task
                </button>
            </div>
        </div>
    </div>

    <!-- Tooltip for Tasks -->
    <div id="task-tooltip" class="task-tooltip p-4 rounded-lg shadow-lg bg-gray-800 text-white text-sm whitespace-nowrap hidden transition-opacity duration-300 z-50">
        <h4 class="font-bold mb-2 text-gray-100">Tasks:</h4>
        <ul id="tooltip-task-list" class="list-disc pl-4 space-y-1"></ul>
    </div>

    <script>
        // Initial sample intern data with nested tasks
        let internData = [
            { id: '1', name: 'Jane Doe', projects: ['Data Migration', 'UI/UX Redesign'], tasks: [
                { name: 'Migrate old data', status: 'Completed', score: 95 },
                { name: 'User flow analysis', status: 'In Progress', score: 0 }
            ]},
            { id: '2', name: 'John Smith', projects: ['UI/UX Redesign', 'Mobile App Development'], tasks: [
                { name: 'Wireframing', status: 'Completed', score: 85 },
                { name: 'Prototype creation', status: 'In Progress', score: 0 }
            ]},
            { id: '3', name: 'Emily Jones', projects: ['Mobile App Development'], tasks: [
                { name: 'Develop login screen', status: 'Completed', score: 91 },
                { name: 'Implement user profile', status: 'Completed', score: 93 }
            ]},
            { id: '4', name: 'Michael Brown', projects: ['Backend API Integration'], tasks: [
                { name: 'Design REST API', status: 'Completed', score: 85 },
                { name: 'Connect to database', status: 'In Progress', score: 0 }
            ]},
            { id: '5', name: 'Sarah Miller', projects: ['Frontend Optimization'], tasks: [
                { name: 'Refactor CSS', status: 'Completed', score: 98 },
                { name: 'Optimize JS bundle', status: 'Completed', score: 96 }
            ]},
            { id: '6', name: 'David Wilson', projects: ['Machine Learning Model'], tasks: [
                { name: 'Data collection', status: 'Not Started', score: 0 }
            ]},
            { id: '7', name: 'Jessica Davis', projects: ['Cloud Infrastructure', 'Backend API Integration'], tasks: [
                { name: 'Setup CI/CD pipeline', status: 'Completed', score: 89 },
                { name: 'Configure cloud storage', status: 'In Progress', score: 0 }
            ]},
            { id: '8', name: 'Chris Evans', projects: ['Database Management'], tasks: [
                { name: 'Schema design', status: 'Completed', score: 78 }
            ]}
        ];

        let currentSortColumn = null;
        let currentSortDirection = 'asc';
        let myChart = null;

        /**
         * Calculates the average score for a given intern.
         * @param {Object} intern - The intern object.
         * @returns {number} The average score, or 0 if no completed tasks.
         */
        function calculateAverageScore(intern) {
            const completedTasks = intern.tasks.filter(task => task.status === 'Completed');
            if (completedTasks.length === 0) return 0;
            const totalScore = completedTasks.reduce((sum, task) => sum + task.score, 0);
            return totalScore / completedTasks.length;
        }

        /**
         * Renders the intern table with the given data.
         * @param {Array<Object>} data - The array of intern objects to display.
         */
        function renderTable(data) {
            const tableBody = document.getElementById('intern-table-body');
            tableBody.innerHTML = '';
            
            data.forEach(intern => {
                const averageScore = calculateAverageScore(intern);
                const totalTasks = intern.tasks.length;
                const completedTasks = intern.tasks.filter(t => t.status === 'Completed').length;
                
                let statusColor = '';
                if (completedTasks === totalTasks && totalTasks > 0) {
                    statusColor = 'bg-green-100 text-green-800';
                } else if (completedTasks > 0 && completedTasks < totalTasks) {
                    statusColor = 'bg-yellow-100 text-yellow-800';
                } else {
                    statusColor = 'bg-gray-100 text-gray-800';
                }

                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-100 transition-colors';
                
                row.innerHTML = `
                    <td class="py-4 px-6 whitespace-nowrap text-sm font-medium text-gray-900">
                        <span class="intern-name-hover" data-id="${intern.id}" style="cursor: pointer;">${intern.name}</span>
                    </td>
                    <td class="py-4 px-6 whitespace-nowrap text-sm text-gray-500">${intern.projects.join(', ')}</td>
                    <td class="py-4 px-6 whitespace-nowrap">
                        <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${statusColor}">${completedTasks}/${totalTasks} Tasks</span>
                    </td>
                    <td class="py-4 px-6 whitespace-nowrap text-sm text-gray-500">${averageScore.toFixed(0)}/100</td>
                    <td class="py-4 px-6 whitespace-nowrap text-right text-sm font-medium">
                        <button class="view-details-btn text-blue-600 hover:text-blue-900 mr-2" data-id="${intern.id}">View Details</button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }
        
        /**
         * Updates the key metrics on the dashboard based on the current data.
         */
        function updateKeyMetrics(data) {
            const allTasks = data.flatMap(intern => intern.tasks);
            const completedTasks = allTasks.filter(task => task.status === 'Completed').length;
            const totalScore = allTasks.filter(task => task.status === 'Completed').reduce((sum, task) => sum + task.score, 0);
            const projectsAssigned = new Set(data.flatMap(intern => intern.projects)).size;
            
            const averageScore = allTasks.filter(task => task.status === 'Completed').length > 0 ? totalScore / allTasks.filter(task => task.status === 'Completed').length : 0;
            
            document.getElementById('total-tasks').textContent = completedTasks;
            document.getElementById('average-score').innerHTML = `${averageScore.toFixed(0)}<span class="text-xl font-normal text-gray-500">/100</span>`;
            document.getElementById('projects-assigned').textContent = projectsAssigned;
            document.getElementById('actionable-insights').textContent = projectsAssigned; // Just for this example
        }

        /**
         * Renders or updates the Chart.js performance chart.
         * @param {Array<Object>} data - The array of intern objects to display.
         */
        function renderChart(data) {
            const ctx = document.getElementById('performanceChart').getContext('2d');
            
            const labels = data.map(intern => intern.name);
            const scores = data.map(intern => calculateAverageScore(intern));

            if (myChart) {
                myChart.destroy();
            }

            myChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Average Score',
                        data: scores,
                        backgroundColor: 'rgba(59, 130, 246, 0.6)',
                        borderColor: 'rgba(59, 130, 246, 1)',
                        borderWidth: 1,
                        borderRadius: 8
                    }]
                },
                options: {
                    responsive: false,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100
                        }
                    }
                }
            });
        }

        /**
         * Populates the project filter dropdown with unique project names.
         */
        function populateProjectFilter() {
            const allProjects = internData.flatMap(intern => intern.projects);
            const uniqueProjects = [...new Set(allProjects)].sort();
            const projectFilter = document.getElementById('project-filter');
            
            projectFilter.innerHTML = '<option value="all">All Projects</option>';
            uniqueProjects.forEach(project => {
                const option = document.createElement('option');
                option.value = project;
                option.textContent = project;
                projectFilter.appendChild(option);
            });
        }

        /**
         * Handles filtering and searching of the intern data.
         */
        function filterAndSearch() {
            const searchText = document.getElementById('search-input').value.toLowerCase();
            const statusFilter = document.getElementById('status-filter').value;
            const projectFilter = document.getElementById('project-filter').value;

            let filteredData = internData.filter(intern => {
                const matchesSearch = intern.name.toLowerCase().includes(searchText) || intern.projects.some(p => p.toLowerCase().includes(searchText));
                const matchesStatus = statusFilter === 'all' || intern.tasks.some(t => t.status === statusFilter);
                const matchesProject = projectFilter === 'all' || intern.projects.includes(projectFilter);
                return matchesSearch && matchesStatus && matchesProject;
            });

            // Re-apply sorting after filtering
            if (currentSortColumn) {
                filteredData.sort((a, b) => {
                    const valA = typeof a[currentSortColumn] === 'string' ? a[currentSortColumn].toLowerCase() : a[currentSortColumn];
                    const valB = typeof b[currentSortColumn] === 'string' ? b[currentSortColumn].toLowerCase() : b[currentSortColumn];
                    
                    if (valA < valB) return currentSortDirection === 'asc' ? -1 : 1;
                    if (valA > valB) return currentSortDirection === 'asc' ? 1 : -1;
                    return 0;
                });
            }

            renderTable(filteredData);
            renderChart(filteredData);
            updateKeyMetrics(internData);
        }

        /**
         * Opens the modal for adding a new intern.
         */
        function openAddModal() {
            document.getElementById('modal-title').textContent = 'Add New Intern';
            document.getElementById('profile-form').reset();
            document.getElementById('intern-id').value = '';
            document.getElementById('delete-intern-btn').style.display = 'none';
            document.getElementById('profile-modal').style.display = 'flex';
        }

        /**
         * Opens the modal to view and edit an existing intern.
         * @param {string} id - The ID of the intern to view/edit.
         */
        function openEditModal(id) {
            const intern = internData.find(i => i.id === id);
            if (!intern) return;

            document.getElementById('modal-title').textContent = 'Edit Intern Profile';
            document.getElementById('intern-id').value = intern.id;
            document.getElementById('intern-name').value = intern.name;
            document.getElementById('delete-intern-btn').style.display = 'block';
            document.getElementById('profile-modal').style.display = 'flex';
        }

        /**
         * Opens the task details modal for a specific intern.
         * @param {string} id - The ID of the intern.
         */
        function openTaskDetailsModal(id) {
            const intern = internData.find(i => i.id === id);
            if (!intern) return;

            document.getElementById('task-modal-intern-name').textContent = intern.name;
            const taskTableBody = document.getElementById('task-table-body');
            taskTableBody.innerHTML = '';

            intern.tasks.forEach(task => {
                const row = document.createElement('tr');
                let statusColor = '';
                if (task.status === 'Completed') {
                    statusColor = 'bg-green-100 text-green-800';
                } else if (task.status === 'In Progress') {
                    statusColor = 'bg-yellow-100 text-yellow-800';
                } else {
                    statusColor = 'bg-gray-100 text-gray-800';
                }

                row.innerHTML = `
                    <td class="py-4 px-6 text-sm text-gray-900">${task.name}</td>
                    <td class="py-4 px-6"><span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${statusColor}">${task.status}</span></td>
                    <td class="py-4 px-6 text-sm text-gray-500">${task.score}/100</td>
                `;
                taskTableBody.appendChild(row);
            });

            document.getElementById('task-modal').style.display = 'flex';
        }

        /**
         * Handles the form submission to save or add an intern.
         * @param {Event} event - The form submission event.
         */
        function saveIntern(event) {
            event.preventDefault();
            const id = document.getElementById('intern-id').value;
            const name = document.getElementById('intern-name').value;
            
            if (id) {
                const intern = internData.find(i => i.id === id);
                if (intern) {
                    intern.name = name;
                }
            } else {
                const newId = crypto.randomUUID();
                internData.push({ id: newId, name, projects: [], tasks: [] });
            }

            document.getElementById('profile-modal').style.display = 'none';
            filterAndSearch();
        }

        /**
         * Deletes an intern from the data array.
         */
        function deleteIntern() {
            const id = document.getElementById('intern-id').value;
            internData = internData.filter(intern => intern.id !== id);
            document.getElementById('profile-modal').style.display = 'none';
            filterAndSearch();
        }

        /**
         * Shows the tooltip with task details.
         * @param {string} id - The intern ID.
         * @param {number} x - The x-coordinate for positioning.
         * @param {number} y - The y-coordinate for positioning.
         */
        function showTooltip(id, x, y) {
            const intern = internData.find(i => i.id === id);
            if (!intern) return;
            
            const tooltip = document.getElementById('task-tooltip');
            const taskList = document.getElementById('tooltip-task-list');
            taskList.innerHTML = '';

            if (intern.tasks.length === 0) {
                const li = document.createElement('li');
                li.textContent = 'No tasks assigned.';
                taskList.appendChild(li);
            } else {
                intern.tasks.forEach(task => {
                    const li = document.createElement('li');
                    const score = task.status === 'Completed' ? `(${task.score}/100)` : '';
                    li.textContent = `${task.name} - ${task.status} ${score}`;
                    taskList.appendChild(li);
                });
            }

            tooltip.style.left = `${x + 15}px`;
            tooltip.style.top = `${y + 15}px`;
            tooltip.style.display = 'block';
        }

        /**
         * Hides the tooltip.
         */
        function hideTooltip() {
            document.getElementById('task-tooltip').style.display = 'none';
        }


        /**
         * Initializes event listeners and initial rendering.
         */
        document.addEventListener('DOMContentLoaded', () => {
            populateProjectFilter();
            filterAndSearch();

            document.getElementById('generate-report-btn').addEventListener('click', function() {
                const messageBox = document.getElementById('message-box');
                messageBox.classList.remove('hidden');
            });

            document.getElementById('add-intern-btn').addEventListener('click', openAddModal);
            document.getElementById('search-input').addEventListener('input', filterAndSearch);
            document.getElementById('status-filter').addEventListener('change', filterAndSearch);
            document.getElementById('project-filter').addEventListener('change', filterAndSearch);
            
            document.getElementById('profile-form').addEventListener('submit', saveIntern);
            document.getElementById('delete-intern-btn').addEventListener('click', deleteIntern);

            document.querySelectorAll('th.sortable').forEach(header => {
                header.addEventListener('click', () => {
                    const column = header.dataset.sort;
                    if (currentSortColumn === column) {
                        currentSortDirection = currentSortDirection === 'asc' ? 'desc' : 'asc';
                    } else {
                        currentSortColumn = column;
                        currentSortDirection = 'asc';
                    }
                    filterAndSearch();
                });
            });

            document.getElementById('intern-table-body').addEventListener('click', (event) => {
                if (event.target.classList.contains('view-details-btn')) {
                    const id = event.target.dataset.id;
                    openTaskDetailsModal(id);
                }
            });

            document.getElementById('intern-table-body').addEventListener('mouseover', (event) => {
                const internNameElement = event.target.closest('.intern-name-hover');
                if (internNameElement) {
                    const id = internNameElement.dataset.id;
                    showTooltip(id, event.clientX, event.clientY);
                }
            });

            document.getElementById('intern-table-body').addEventListener('mouseout', (event) => {
                hideTooltip();
            });
        });
    </script>
</body>
</html>
